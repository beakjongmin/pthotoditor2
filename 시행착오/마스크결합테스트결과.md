# ë§ˆìŠ¤í¬ ê²°í•© ë¬¸ì œ í•´ê²° ê¸°ë¡

## ğŸ“Š ì‹¤í—˜: Soft Alpha Mask vs Hard Alpha Mask

### âœ… í•´ê²° ë°°ê²½:

`SegmentationMask` ëª¨ë¸ì˜ bufferì—ì„œ ì•ŒíŒŒ ë§ˆìŠ¤í¬ë¥¼ ìƒì„±í•  ë•Œ,
confidence ê°’ì´ ì§€ì •ëœ thresholdë³´ë‹¤ ë†’ìœ¼ë©´ 255, ê·¸ ì´í•˜ëŠ” 0ìœ¼ë¡œ ì„¤ì •í•œ **Hard Alpha Mask** ë°©ì‹ì´ ë” ì •êµí•˜ê³  ì•ˆì •ì ì¸ ê²°ê³¼ë¥¼ ë³´ì˜€ë‹¤.

```kotlin
fun toHardAlphaMask(
    mask: SegmentationMask,
    width: Int,
    height: Int,
    threshold: Float = 0.6f
): Bitmap {
    val buffer = mask.buffer
    buffer.rewind()
    val pixels = IntArray(width * height)

    for (i in pixels.indices) {
        val confidence = buffer.float
        val alpha = if (confidence >= threshold) 255 else 0
        pixels[i] = (alpha shl 24) or 0xFFFFFF
    }

    return Bitmap.createBitmap(pixels, width, height, Bitmap.Config.ARGB_8888)
}
```

```kotlin
fun toSoftAlphaMask(
    mask: SegmentationMask,
    width: Int,
    height: Int
): Bitmap {
    val buffer = mask.buffer
    buffer.rewind()
    val pixels = IntArray(width * height)

    for (i in pixels.indices) {
        val confidence = buffer.float
        val alpha = (confidence * 255).toInt().coerceIn(0, 255)
        pixels[i] = (alpha shl 24) or 0xFFFFFF
    }

    return Bitmap.createBitmap(pixels, width, height, Bitmap.Config.ARGB_8888)
}

```

---

## ğŸ”¢ íŒ¨í„´ í†µê³„ ë°ì´í„°:

```
faceAlphaMask:
- alpha=0:     61632
- alpha=255:  164688

jawlineMask:
- alpha=0:     135054
- alpha=255:   91266

faceHairMask:
- alpha=0:     70450
- alpha=255:  155870
```

### ğŸ“Œ Soft maskë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°:

* alpha ê°’ì´ 1\~254ì¸ ê²½ê³„ í”½ì…€ì´ blending ì‹œ ì¤‘ê°„ê°’ìœ¼ë¡œ ì ìš©ë˜ì§€ ì•Šìœ¼ë©´ íš¨ê³¼ê°€ ë¬´ì‹œë¨
* ë¯¸ì„¸í•œ ê·¸ë¼ë°ì´ì…˜ í‘œí˜„ì´ ê°€ëŠ¥í•œ ëŒ€ì‹  ì²˜ë¦¬ ê²°ê³¼ê°€ ì˜ˆìƒ ì™¸ë¡œ ë²ˆì§ˆ ìˆ˜ ìˆìŒ

### ğŸ“Œ Hard maskë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°:

* 255/0 ìœ¼ë¡œ ì´ì§„ ì²˜ë¦¬ë˜ë¯€ë¡œ ë§ˆìŠ¤í‚¹/ë¸”ë Œë”© ì²˜ë¦¬ ê²°ê³¼ê°€ ëª…í™•í•¨
* ê²½ê³„ ì²˜ë¦¬ê°€ ë‚ ì¹´ë¡œìš¸ ìˆ˜ ìˆìœ¼ë‚˜ featheringì„ ë³‘í–‰í•˜ë©´ ìì—°ìŠ¤ëŸ¬ì›€ í™•ë³´ ê°€ëŠ¥

---

## ğŸ›  ë¬¸ì œ í•´ê²° ê³¼ì •:

1. ê¸°ì¡´ì—ëŠ” `toGrayMat()` í•¨ìˆ˜ë¥¼ í†µí•´ ë§ˆìŠ¤í¬ë¥¼ ìƒì„±í–ˆìœ¼ë‚˜, ì´ ë°©ì‹ì€ ìƒ‰ìƒì˜ ë°ê¸°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ë¶ˆì™„ì „í•œ ì˜ì—­ ì¸ì‹ ë°œìƒ
2. `toAlphaMat()`ì„ ë„ì…í•˜ì—¬ ì‹¤ì œ ì•ŒíŒŒ ì±„ë„ ê¸°ë°˜ì˜ ì •ë°€í•œ ë§ˆìŠ¤í¬ ì²˜ë¦¬ êµ¬í˜„
3. SoftMaskë³´ë‹¤ HardMaskì˜ blending ê²°ê³¼ê°€ í†µê³„ì ìœ¼ë¡œ ë” ì¼ê´€ë˜ê³  í’ˆì§ˆì´ ë†’ì•˜ìŒ

---

## ğŸ’¡ ê²°ë¡ :

* "ë¨¸ë¦¬ì¹´ë½ê³¼ ì–¼êµ´ì„ í¬í•¨í•œ ìµœì¢… ë§ˆìŠ¤í¬"ëŠ” segmentMaskì™€ jawlineMaskê°€ ì •í™•í•œ alpha ì±„ë„ì„ ê°€ì§€ê³  ìˆì–´ì•¼ ì •í™•í•œ ì˜ì—­ ë¸”ë Œë”©ì´ ê°€ëŠ¥
* SoftMaskëŠ” blending ê°•ë„ë‚˜ feathering ì¡°ê±´ì´ ì •ë°€í•˜ì§€ ì•Šìœ¼ë©´ íš¨ê³¼ê°€ ë°˜ì˜ë˜ì§€ ì•ŠìŒ
* HardMaskëŠ” ì›í•˜ëŠ” ì˜ì—­ë§Œ ì •í™•í•˜ê²Œ ì²˜ë¦¬ ê°€ëŠ¥í•˜ë©°, feather ë§ˆìŠ¤í¬ë¡œ ë¶€ë“œëŸ¬ìš´ ê²½ê³„ êµ¬í˜„ì´ ê°€ëŠ¥

---

ì´ ê¸°ë¡ì€ í–¥í›„ ë§ˆìŠ¤í¬ ê²°í•© ì²˜ë¦¬ ë° blending ì²˜ë¦¬ ìµœì í™” ì‘ì—… ì‹œ ê¸°ì¤€ì ì´ ë  ìˆ˜ ìˆë‹¤.
